<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="../css/reset.css">
		<link rel="stylesheet" href="../css/reveal.css">
		<link rel="stylesheet" href="../css/theme/beige.css">
		<link rel="stylesheet" href="../css/custom.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="../lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../css/print/pdf.css' : '../css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h2>Chap 2 : Refactoring</h2>

					<div class="img-row">					
						<img src="../img/iut.jpg" />
						<div>
							<p style="font-size: 16px">M4104 - PEL : Agilité et bonnes pratiques de programmation</p>
							<p style="font-size: 16px">Institut Universitaire de Technologie de Bayonne et du Pays Basque</p>
							<p style="font-size: 16px">Robin Lucbernet - Christophe Marquesuzàa - Damien Urruty</p>
							<p style="font-size: 16px">DUT Informatique 2019 / 2020 - Semestre 4</p>
						</div>
					</div>
				</section>
				<section>
					<h2>Définition</h2>
					<ul>
						<li class="fragment">Opération consistant à améliorer un code existant...</li>
						<li class="fragment">pour le rendre plus lisible et maintenable...</li>
						<li class="fragment">sans en changer le fonctionnement</li>
					</ul>
				</section>
				<section>
					<h2>Règles</h2>
					<ul>
						<li class="fragment">Le code doit devenir plus propre</li>
						<li class="fragment">Aucune fonctionnalité n'est modifiée/introduite</li>
						<li class="fragment">Pas de refactoring sans tests automatiques</li>
						<li class="fragment">Les tests passent toujours à la fin</li>
					</ul>
				</section>
				<section>
					<h2>Référence</h2>
					<h4>Refactoring de Martin Fowler</h4>
					<img src="../img/refactoring-book-cover.jpg" />
				</section>
				<section>
					<h2>Quand l'utiliser ?</h2>
					<img src="../img/refactor-then-make-change.png" />
				</section>
				<section>
					<h2>Quand l'utiliser ?</h2>
					<h3>La fenêtre cassée</h3>
					<img src="../img/house-broken-window.jpg" />
				</section>
				<section>
					<h2>Quand l'utiliser ?</h2>
					<h3>La règle du boy scout</h3>
					<blockquote>"Essayez de laisser ce monde un peu meilleur qu'il ne l'était quand vous y êtes venus"<footer>- Robert Baden-Powell</footer></blockquote>
				</section>
				<section>
					<h2>Quand l'utiliser ?</h2>
					<p>Pendant le temps où l'on fait du refactor, on n'ajoute pas de fonctionnalité...</p>
					<p>=> Il faut que la décision soit partagée par les parties prenantes</p>
				</section>
				<section>
					<h2>Comment l'utiliser ?</h2>
					<p>Attention aux gros refactorings !</p>
					</p>=> Procéder par étapes intermédiaires</p>
				</section>
				<section>
					<h2>Code smells</h2>
					<img src="../img/code-smell.jpg" />
				</section>
				<section>
					<h2>Code smells</h2>
					<ul>
						<li class="fragment">Du code qui ne sent pas bon...</li>
						<li class="fragment">Se dit d'une portion de code mal conçue, pas très lisible, difficile à comprendre et à faire évoluer</li>
						<li class="fragment">Il existe différentes catégories de smells</li>
					</ul>
				</section>
				<section>
					<h2>Code smells</h2>
					<ul>
						<li class="fragment">Il est important de mettre des mots sur du code qui pose problème</li>
						<li class="fragment">Notamment durant une revue de code</li>
						<li class="fragment">Les smells sont regroupés en différentes catégories</li>
					</ul>
				</section>
				<section>
					<h2>Code smells</h2>
					<img src="../img/smell-words.png" />
				</section>
				<section>
					<h2>Gonfleurs <span class="translation">(Bloaters)</span></h2>
					<img src="../img/gargantua.jpg" />
				</section>
				<section>
					<h2>Méthode longue</h2>
					<ul>
						<li>Une méthode est dite longue quand elle ne tient pas sur un écran (quelques dizaines de lignes)</li>
						<li>C'est souvent le signe qu'elle fait trop de choses</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Eclater en plusieurs méthodes et/ou classes</p>
				</section>
				<section>
					<h2>Longue classe</h2>
					<ul>
						<li>Une classe est dite longue quand elle comporte beaucoup de champs, de méthodes (quelques centaines de lignes au total)</li>
						<li>C'est souvent le signe qu'elle fait trop de choses</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Eclater en plusieurs classes</p>
				</section>
				<section>
					<h2>Obsession des primitifs</h2>
					<ul>
						<li>On trouve souvent du code qui abuse des types primitifs (int, String, boolean...)</li>
						<li>La plage de valeurs possibles est souvent trop grande</li>
						<li>Cela ne documente pas la raison d'être de ces valeurs</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Utiliser des types plus précis (un type Price au lieu d'un int, un type Name au lieu de 2 Strings...)</p>
				</section>
				<section>
					<h2>Longue liste de paramètres</h2>
					<ul>
						<li>Une liste de paramètres est dite longue si elle comporte 7-8 paramètres ou plus</li>
						<li>C'est souvent le fait de changements incrémentaux</li>
						<li>Augmente mécaniquement la taille de la méthode ou du constructeur</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Eclater en plusieurs méthodes ou grouper les paramètres dans un type</p>
				</section>
				<section>
					<h2>Paquet de données</h2>
					<ul>
						<li>Un groupe de paramètres ou de variables se répète à différents endroits</li>
						<li>Cela peut être le signe d'un copier/coller</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Extraire ces informations dans une classe dédiée</p>
				</section>
				<section>
					<h2>Détournements de l'orienté-objet <span class="translation">(Object-Orientation abusers)</span></h2>
					<img src="../img/misused.jpg" />
				</section>
				<section>
					<h2>Classes alternatives avec interfaces différentes</h2>
					<ul>
						<li>Deux classes qui font la même chose mais qui n'ont pas les mêmes signatures de méthodes</li>
						<li>Peut arriver quand deux développeurs travaillent sur des thèmes liés sans se concerter</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Garder une seule de ces classes</p>
				</section>
				<section>
					<h2>Refus d'héritage</h2>
					<ul>
						<li>Une classe fille n'utilise que certains éléments de sa classe parent</li>
						<li>L'héritage n'est sans doute pas la bonne solution dans ce cas</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Favoriser la composition à l'héritage</p>
				</section>
				<section>
					<h2>Instructions switch</h2>
					<ul>
						<li>Imbrication complexe de switch et/ou de if</li>
						<li>Augmente mécaniquement la taille de la méthode ou du constructeur</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Encapsuler ces comportements dans des classes</p>
				</section>
				<section>
					<h2>Champs temporaires</h2>
					<ul>
						<li>Certains champs ne servent que dans certaines conditions ce qui peut prêter à confusion</li>
						<li>Cela complique la compréhension du programme</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Extraire ces champs vers une autre classe</p>
				</section>
				<section>
					<h2>Freins au changement <span class="translation">(Change preventers)</span></h2>
					<img src="../img/tree-road.jpg" />
				</section>
				<section>
					<h2>Changement divergent</h2>
					<ul>
						<li>Ajouter une fonctionnalité implique de changer beaucoup de code qui ne semble pas lié</li>
						<li>C'est le signe que le code est trop couplé (copier/coller ?)</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Extraire ce code dupliqué vers une même méthode/classe</p>
				</section>
				<section>
					<h2>Hiérarchies d'héritage parallèles</h2>
					<ul>
						<li>Ajouter une sous-classe dans une hiérarchie implique de rajouter une sous-classe ailleurs</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Réorganiser la hiérarchie</p>
				</section>
				<section>
					<h2>Chirurgie au fusil à pompe</h2>
					<ul>
						<li>Faire un changement implique de modifier beaucoup de fichiers différents</li>
						<li>L'organisation du code est probablement à revoir</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Identifier les duplications et réorganiser le code</p>
				</section>
				<section>
					<h2>Superflus <span class="translation">(Dispensables)</span></h2>
					<img src="../img/dispensable.jpg" />
				</section>
				<section>
					<h2>Commentaires</h2>
					<ul>
						<li>La plupart des commentaires peuvent être enlevés en ayant du code qui se documente tout seul</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Ecrire du code qui se documente tout seul... puis enlever ces commentaires</p>
				</section>
				<section>
					<h2>Code dupliqué</h2>
					<ul>
						<li>Souvent le fait d'un copier/coller, du code dupliqué est compliqué à maintenir</li>
						<li>Si on fait un changement il faut bien penser à le faire partout sous peine de bug</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Factoriser ce code dupliqué</p>
				</section>
				<section>
					<h2>Code mort</h2>
					<ul>
						<li>Le code mort ne sert pas</li>
						<li>Il pollue donc la base de code</li>
						<li>Si besoin on peut le retrouver grâce au versioning</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Supprimer le code mort</p>
				</section>
				<section>
					<h2>Classe fainéante</h2>
					<ul>
						<li>C'est une classe qui ne fait quasiment rien</li>
						<li>On peut se poser la question de sa pertinence</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Supprimer cette classe</p>
				</section>
				<section>
					<h2>Généralité spéculative</h2>
					<ul>
						<li>On prévoit du code "au cas où", dont on aura peut-être besoin plus tard</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Ne pas écrire du code "au cas où" (voir YAGNI)</p>
				</section>
				<section>
					<h2>Coupleurs <span class="translation">(Couplers)</span></h2>
					<img src="../img/weld.jpg" />
				</section>
				<section>
					<h2>Envie de fonctionnalité</h2>
					<ul>
						<li>Une classe accède à beaucoup d'informations d'une autre pour réaliser des traitements</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Déplacer le code dans la classe "enviée"</p>
				</section>
				<section>
					<h2>Intimité inappropriée</h2>
					<ul>
						<li>Une classe accède à des informations "internes" d'une autre classe</li>
						<li>Cela casse la règle d'encapsulation</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Déplacer le traitement dans la classe "épiée"</p>
				</section>
				<section>
					<h2>Chaine de messages</h2>
					<ul>
						<li>Pour pouvoir appeler une méthode, on doit passer par une chaine d'appels intermédiaires</li>
						<li>Cela signifie que la méthode qui nous intéresse est "trop loin" de nous</li>
					</ul>
					<p class="recommendation-title">> Recommandation</p>
					<p>&#128161 Créer de nouvelles méthodes qui propagent les appels</p>
				</section>
				<section>
					<h2>Mouvements de refactoring</h2>
					<ul>
						<li>Une fois que l'on a indentifié un smell, il existe un ou plusieurs mouvements associés</li>
						<li>On peut trouver une liste sur : <a href="https://refactoring.com/">https://refactoring.com</a></li>
					</ul>
				</section>
			</div>
		</div>

		<script src="../js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				pdfSeparateFragments: false,
				slideNumber: true,
				hash: true,
				dependencies: [
					{ src: '../plugin/markdown/marked.js' },
					{ src: '../plugin/markdown/markdown.js' },
					{ src: '../plugin/notes/notes.js', async: true },
					{ src: '../plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
	</body>
</html>
